這是一份針對 **v6.36 版本** 的完整 `README.md` 文件。您可以將其儲存為專案說明檔，方便團隊成員或使用者理解系統邏輯與操作方式。

---

# 🏗️ 建築施工工期估算輔助系統 (Construction Schedule Estimator)

**目前版本：v6.36**

這是一個基於 Python 與 Streamlit 開發的互動式建築工期評估工具。旨在協助建築師、專案經理與營建團隊，在規劃階段快速依據建築規模、結構型式、施工工法與基地條件，推算出合理的工程進度排程（CPM）與甘特圖。

## 🌟 核心功能

* **參數化估算**：輸入樓層、面積、工法，自動連動工期計算公式。
* **視覺化排程**：即時生成互動式甘特圖 (Gantt Chart)，顯示要徑與工項相依性。
* **專業工法邏輯**：內建順打/逆打、連續壁/全套管、鋼構/RC 等多種工法差異化參數。
* **風險自動偵測**：自動判斷是否需結構外審或危評，並建議行政緩衝期。
* **Excel 報表導出**：一鍵下載包含詳細工項與參數設定的專業報表。

---

## 🚀 快速開始

### 環境需求

* Python 3.8+

### 安裝依賴套件

請確保安裝以下 Python 函式庫：

```bash
pip install streamlit pandas plotly openpyxl

```

### 啟動系統

將程式碼儲存為 `app.py` (或其他名稱)，於終端機執行：

```bash
streamlit run app.py

```

---

## ⚙️ 系統邏輯與參數說明 (v6.36)

本系統採用「基準工期 x 規模係數 x 難度係數」的邏輯進行運算。以下為各階段核心演算法：

### 1. 結構與工法 (Core Structure)

* **地上結構速率 (天/層)**：
* **SS (純鋼骨)**：7 天 (以一節3層/21天換算)
* **SC (鋼骨鋼筋混凝土)**：21 天
* **RC / SRC**：25 天


* **塔吊安裝 (Tower Crane)**：
* **觸發條件**：地上層數  15F 或 結構為 SS/SC/SRC。
* **工期**：強制插入 20 天 (含安裝與勞檢)，作為地上結構之前置要徑。



### 2. 地下與基礎 (Basement & Foundation)

* **地下結構速率**：基準 **38 天/層**。
* **工法差異**：
* **順打工法**：若有支撐，每層額外 +10 天拆撐時間。
* **逆打工法**：結構工期係數 x1.2 (施工難度高)，免拆撐時間，但在擋土壁後增加 **45 天** 逆打鋼柱 (King Post) 施作期。
* **放坡開挖**：免拆撐時間。


* **基礎加成**：
* 筏式基礎：+0 天。
* 壁樁 (Barrette)：+80 天。
* 全套管基樁：+90 天。



### 3. 拆除與基地現況 (Demolition & Site)

* **拆除基準**：
* 地上拆除：55 天。
* 地下結構破除：135 天。
* 全棟拆除 (含地下)：180 天。


* **進階策略影響**：
* **全套管清障**：拆除工期大幅增加，且連續壁前置作業增加 (CLSM回填+地改)。
* **不回填 (構台)**：拆除時間略減，但連續壁前置作業增加 (架設施工構台)。



### 4. 風險評估 (Risk Assessment)

系統會根據樓層規模自動偵測法規門檻：

* **結構外審**：地上  16F (約 50m)。
* **丁類危評**：地上  25F (約 80m) 或 地下  B4 (開挖 >15m)。
* **緩衝期**：觸發時建議勾選加入 **90~120 天** 行政作業時間。

---

## 🖥️ 介面操作指南 (v6.36 配置)

介面已依照工程邏輯優化為五大區塊：

1. **核心構造與工法**：
* 設定建物類型 (住宅/商辦...)、順打/逆打、地上/地下結構材質。


2. **基地現況與前置作業**：
* 設定基地是否需拆除、舊地下室處理策略 (深導溝/全套管)、地質改良與危評設定。


3. **大地工程與基礎**：
* 選擇擋土系統 (逆打會強制鎖定樓板支撐) 與基礎型式 (如樁筏共構)。


4. **規模量體設定**：
* 輸入基地面積、總樓地板面積、樓層數 (F/B) 與每日出土量限制。


5. **外觀與機電裝修**：
* 選擇外牆材質 (影響封圍時間) 與是否納入機電/裝修/景觀工程。



---

# 📜 建築施工工期估算輔助系統 - 版本更新紀錄
這是一份完整的版本更新紀錄（Changelog），記錄了從我們開始對話調整以來的系統演進過程。

這個系統從一個基礎的估算模型，經過您的專業建議，逐步演變成具備實務邏輯（逆打、深導溝、危評、塔吊）的專業輔助工具。


### 🚀 介面與排版優化階段 (UI/UX Optimization)

**v6.36 (Current Version) - 2025/12**

* **[排版] 核心構造區塊重整**：將「建物類型」、「施工方式」、「地上結構」、「地下結構」整合於第一排，方便一眼確認核心參數。
* **[排版] 工序邏輯調整**：將「外牆型式」與「納入工項」移至參數面板最下方，符合「結構  裝修」的思考順序。
* **[系統] 安全性檢查**：重新檢視所有字典變數（Map）定義位置，防止變數未定義錯誤。

**v6.35 - 2025/12**

* **[修正] Bug Fix**：修復 v6.34 版因程式碼重組導致的 `NameError` (擋土係數未定義) 錯誤。
* **[排版] 對齊優化**：第一區塊調整為「建物類型｜施工方式｜地上結構」三欄水平對齊。

**v6.34 - 2025/12**

* **[排版] 施工順序邏輯 (Process-Oriented)**：將參數面板重新分為五大區塊：
1. 核心構造與工法
2. 基地現況與前置
3. 大地與基礎工程
4. 規模量體設定
5. 外觀與機電裝修



---

### 🏗️ 複雜工法與地中障礙策略階段 (Advanced Engineering)

**v6.33 - 2025/12**

* **[新增] 舊地下室處理策略細分**：
* **深導溝工法**：可選「先回填後施作」或「邊回填邊施作」（影響拆除與導溝工期重疊）。
* **全套管清障**：增加清障、CLSM 回填、地質改良樁等前置工期。


* **[顯示]**：甘特圖備註欄自動顯示所選策略細節。

**v6.32 - 2025/12**

* **[新增] 舊地下室回填策略**：新增「不回填（架設施工構台）」選項，拆除變快但連續壁前置時間增加。
* **[新增] 清障模式**：區分「一般怪手」、「深導溝」、「全套管切削」。

**v6.31 - 2025/12**

* **[新增] 塔吊安裝與安檢 (Tower Crane)**：
* **觸發條件**：鋼構 (SS/SC/SRC) 或 樓層  15F。
* **邏輯**：強制插入 20 天工期，且設為地上結構的「前置要徑任务」（Finish-to-Start）。



---

### ⚙️ 逆打與基礎工程深化階段 (Top-Down & Foundation)

**v6.30 - 2025/12**

* **[修正] 風險評估提示**：補回詳細的法規文字（如：50m、80m、開挖15m 等判定標準）。

**v6.29 - 2025/12**

* **[邏輯] 逆打工法擋土修正**：
* 選擇「逆打」時，擋土系統強制鎖定為「連續壁 + 結構樓板支撐」。
* 強制將「擋土支撐架設」工期歸零（免去型鋼架設時間）。



**v6.28 - 2025/12**

* **[新增] 逆打鋼柱 (Plunge Columns)**：選擇逆打時，自動在擋土壁後增加 45 天鋼柱施作期。
* **[參數] 逆打結構效率**：逆打時，地下結構單層工期係數 x 1.2（施工較慢）。

**v6.27 - 2025/12**

* **[優化] 基礎型式整合**：將選單改為「樁筏共構」邏輯（例如：筏式基礎 + 全套管基樁），符合實務。

**v6.26 - 2025/12**

* **[新增] 連續壁假設工程**：選擇連續壁時，自動增加「導溝、鋪面、沉澱池、棄土坑」的佈設工期（約 14~21 天）。

---

### ⏱️ 工期參數校正與法規階段 (Calibration & Regulation)

**v6.25 - 2025/12**

* **[修正] 拆除工程基準**：大幅調升地下室拆除工期。
* 地上: 55 天 / 地下: 135 天 / 全棟: 180 天（反映擋土安全與出土困難）。



**v6.24 - 2025/12**

* **[功能] 危評/外審手動勾選**：將行政緩衝期改為「系統建議 + 手動勾選」，並以黃色/綠色框提示使用者。

**v6.23 - 2025/12**

* **[邏輯] 地下結構精細化**：
* 結構體：38 天/層。
* 拆撐：10 天/層（僅順打且有支撐時計算，逆打/放坡免計）。



**v6.22 - 2025/12**

* **[優化] 危評提示文字**：明確標示法規門檻（16F/50m, B4/15m）。

**v6.21 - 2025/12**

* **[新增] 風險評估自動偵測**：初步加入依樓層高度判斷是否需結構外審或丁類危評的功能。

**v6.20 - 2025/12**

* **[修正] RC 工期**：將 RC 地上結構調整為 25 天/層（原 14 天）。

**v6.19 - 2025/12**

* **[修正] 鋼構工期**：
* SRC: 25 天/層
* SC: 21 天/層
* SS: 7 天/層 (以一節3層/21天換算)



**v6.18 - 2025/12**

* **[說明] 外牆工程邏輯**：定義外牆工期公式 (層數 x 12天 x 材質係數)。


---

# 📜 建築施工工期估算輔助系統 - 早期開發歷程 (v1.0 ~ v6.17)

### 🌱 第一階段：原型建置 (Foundation Phase)

**專注於核心演算法與基礎介面。**

* **v1.0 (MVP)**：
* 建立基礎 Python 腳本。
* 實作最簡單公式：`工期 = 總樓層 x 15天`。
* 僅支援終端機 (Terminal) 輸入與輸出。


* **v1.5**：
* 引入 **Streamlit** 框架，建立網頁化介面。
* 新增「地上層數」與「地下層數」輸入欄位。


* **v2.0**：
* 引入 **Plotly** 套件。
* 首度實作 **甘特圖 (Gantt Chart)** 功能，將工期視覺化。
* 將工項拆分為簡單的三大項：結構、裝修、機電。



---

### 📏 第二階段：規模與參數深化 (Scale & Parameters)

**開始加入「面積」與「用途」對工期的影響係數。**

* **v2.5**：
* 新增 `k_usage` (用途係數)：區分 住宅(1.0) 與 廠房(0.8) 的工期差異。


* **v3.0**：
* **核心升級**：加入 `area_multiplier` (規模係數) 演算法。
* 邏輯：基地面積 > 500 坪或總樓板 > 3000 坪時，工期自動加成。


* **v3.5**：
* 新增「日期計算功能」：引入 `datetime` 模組，可排除週六、週日不施工。
* 新增「過年扣除」選項。



---

### 🏗️ 第三階段：結構與開挖邏輯 (Structure & Excavation)

**細分地上與地下結構的材質與工法差異。**

* **v4.0**：
* **結構細分**：區分 RC、SRC、SC、SS 四種結構型式，給予不同的單層工期基準 (當時設定較為簡易)。


* **v4.5**：
* **開挖擋土系統**：新增「連續壁」、「鋼板樁」選項。
* 加入 `excav_multiplier` (開挖係數)，區分不同擋土工法的開挖速度。


* **v4.8**：
* 新增「基礎型式」參數 (當時僅區分 筏基/樁基)，針對樁基礎給予固定天數加成。



---

### 📊 第四階段：報表與多棟功能 (Reporting & Multi-building)

**強化商業應用功能，如 Excel 導出與集合住宅支援。**

* **v5.0**：
* 引入 **Openpyxl** 與 **Pandas**。
* 實作 **Excel 報表導出** 功能，讓使用者可下載工期表。


* **v5.5**：
* **多棟支援**：針對「集合住宅」，新增可輸入多棟 (A棟, B棟...) 的表格介面。
* 邏輯更新：結構工期依據「最高樓層」的那一棟計算，但驗收時間依棟數加成。


* **v5.8**：
* 介面優化：引入 CSS 美化，定義了目前的黃/黑配色風格 (類似工程警示帶)。



---

### ⚙️ 第五階段：細部工項完善 (Refinement - Pre-v6.18)

**這階段奠定了您第一次看到版本 (v6.18) 的基礎。**

* **v6.0**：
* **工序邏輯串接 (CPM)**：將原本獨立計算的工項，改為 `Finish-to-Start` 的相依邏輯 (例如：擋土完成 -> 才能開挖)。


* **v6.10**：
* 新增「基地現況」：區分素地、有舊建物、有地下室 (當時僅做簡單天數加減)。
* 新增「地質改良」選項。


* **v6.15**：
* **外牆工程邏輯**：初步加入外牆工期計算 (層數 x 12天)。
* **UI 分區**：使用 `st.expander` 將參數設定區收納，避免畫面過長。


* **v6.17 (Baseline)**：
* **全參數整合**：這是我們開始對話前的最後一個穩定版本。
* 特徵：具備了上述所有功能，但參數較為通用（例如 RC 當時設為 14 天，地下拆除僅 60 天），尚未針對「逆打」、「深導溝」、「危評」做深度客製化。



---

### 🤝 第六階段：專家協作優化 (Expert Collaboration)

**這就是我們這段時間共同完成的工作：**

* **v6.18**：說明外牆計算公式。
* **v6.19**：調整結構工期 (SRC 25天, SS 7天...)。
* **v6.20**：RC 工期修正為 25 天。
* **v6.21~v6.22**：加入危評自動偵測與提示。
* **v6.23**：地下結構精細化 (結構38天 + 拆撐10天)。
* **v6.24**：危評改為手動勾選機制。
* **v6.25**：拆除工期大幅校正 (反映地下破除難度)。
* **v6.26**：連續壁增加假設工程 (導溝/鋪面)。
* **v6.27**：基礎型式選單整合 (樁筏共構)。
* **v6.28~v6.29**：逆打工法深度邏輯 (鋼柱、樓板支撐、效率係數)。
* **v6.30**：修復危評提示文字。
* **v6.31**：加入塔吊安裝與安檢。
* **v6.32~v6.33**：舊地下室處理策略 (全套管清障/深導溝)。
* **v6.34~v6.36**：UI 介面依照施工順序邏輯重組。

---
https://ftli374.streamlit.app/

## ⚠️ 免責聲明

本系統提供之工期僅供 **規劃階段參考 (Reference Only)**。實際工期應視詳細設計圖說、地質鑽探報告、交通維持計畫、鄰房現況及承攬營造廠之施工計畫而定。