這是一份針對 **v6.36 版本** 的完整 `README.md` 文件。您可以將其儲存為專案說明檔，方便團隊成員或使用者理解系統邏輯與操作方式。

---

# 🏗️ 建築施工工期估算輔助系統 (Construction Schedule Estimator)

**目前版本：v6.36**

這是一個基於 Python 與 Streamlit 開發的互動式建築工期評估工具。旨在協助建築師、專案經理與營建團隊，在規劃階段快速依據建築規模、結構型式、施工工法與基地條件，推算出合理的工程進度排程（CPM）與甘特圖。

## 🌟 核心功能

* **參數化估算**：輸入樓層、面積、工法，自動連動工期計算公式。
* **視覺化排程**：即時生成互動式甘特圖 (Gantt Chart)，顯示要徑與工項相依性。
* **專業工法邏輯**：內建順打/逆打、連續壁/全套管、鋼構/RC 等多種工法差異化參數。
* **風險自動偵測**：自動判斷是否需結構外審或危評，並建議行政緩衝期。
* **Excel 報表導出**：一鍵下載包含詳細工項與參數設定的專業報表。

---

## 🚀 快速開始

### 環境需求

* Python 3.8+

### 安裝依賴套件

請確保安裝以下 Python 函式庫：

```bash
pip install streamlit pandas plotly openpyxl

```

### 啟動系統

將程式碼儲存為 `app.py` (或其他名稱)，於終端機執行：

```bash
streamlit run app.py

```

---

## ⚙️ 系統邏輯與參數說明 (v6.36)

本系統採用「基準工期 x 規模係數 x 難度係數」的邏輯進行運算。以下為各階段核心演算法：

### 1. 結構與工法 (Core Structure)

* **地上結構速率 (天/層)**：
* **SS (純鋼骨)**：7 天 (以一節3層/21天換算)
* **SC (鋼骨鋼筋混凝土)**：21 天
* **RC / SRC**：25 天


* **塔吊安裝 (Tower Crane)**：
* **觸發條件**：地上層數  15F 或 結構為 SS/SC/SRC。
* **工期**：強制插入 20 天 (含安裝與勞檢)，作為地上結構之前置要徑。



### 2. 地下與基礎 (Basement & Foundation)

* **地下結構速率**：基準 **38 天/層**。
* **工法差異**：
* **順打工法**：若有支撐，每層額外 +10 天拆撐時間。
* **逆打工法**：結構工期係數 x1.2 (施工難度高)，免拆撐時間，但在擋土壁後增加 **45 天** 逆打鋼柱 (King Post) 施作期。
* **放坡開挖**：免拆撐時間。


* **基礎加成**：
* 筏式基礎：+0 天。
* 壁樁 (Barrette)：+80 天。
* 全套管基樁：+90 天。



### 3. 拆除與基地現況 (Demolition & Site)

* **拆除基準**：
* 地上拆除：55 天。
* 地下結構破除：135 天。
* 全棟拆除 (含地下)：180 天。


* **進階策略影響**：
* **全套管清障**：拆除工期大幅增加，且連續壁前置作業增加 (CLSM回填+地改)。
* **不回填 (構台)**：拆除時間略減，但連續壁前置作業增加 (架設施工構台)。



### 4. 風險評估 (Risk Assessment)

系統會根據樓層規模自動偵測法規門檻：

* **結構外審**：地上  16F (約 50m)。
* **丁類危評**：地上  25F (約 80m) 或 地下  B4 (開挖 >15m)。
* **緩衝期**：觸發時建議勾選加入 **90~120 天** 行政作業時間。

---

## 🖥️ 介面操作指南 (v6.36 配置)

介面已依照工程邏輯優化為五大區塊：

1. **核心構造與工法**：
* 設定建物類型 (住宅/商辦...)、順打/逆打、地上/地下結構材質。


2. **基地現況與前置作業**：
* 設定基地是否需拆除、舊地下室處理策略 (深導溝/全套管)、地質改良與危評設定。


3. **大地工程與基礎**：
* 選擇擋土系統 (逆打會強制鎖定樓板支撐) 與基礎型式 (如樁筏共構)。


4. **規模量體設定**：
* 輸入基地面積、總樓地板面積、樓層數 (F/B) 與每日出土量限制。


5. **外觀與機電裝修**：
* 選擇外牆材質 (影響封圍時間) 與是否納入機電/裝修/景觀工程。



---

## 📝 版本更新紀錄

* **v6.36 (Current)**：
* 🎨 **UI 優化**：參數面板依照施工順序重新編排，核心構造採水平並列佈局。
* 🐛 **Bug Fix**：修復變數定義順序錯誤。


* **v6.33**：新增舊地下室處理策略（深導溝順序、全套管清障、回填/不回填對工期的影響）。
* **v6.31**：新增塔吊安裝與安檢邏輯，自動判斷高層或鋼構建築需求。
* **v6.29**：優化逆打工法邏輯（強制樓板支撐、免臨時支撐架設工期）。
* **v6.25**：大幅修正拆除工程基準天數，反映地下室破除實務難度。
* **v6.20**：調整 RC 結構單層工期至 25 天。

---

## ⚠️ 免責聲明

本系統提供之工期僅供 **規劃階段參考 (Reference Only)**。實際工期應視詳細設計圖說、地質鑽探報告、交通維持計畫、鄰房現況及承攬營造廠之施工計畫而定。